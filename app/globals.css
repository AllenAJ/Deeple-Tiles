@import 'tailwindcss';
@import 'tw-animate-css';

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

@utility debug {
  outline-width: 2px;
  outline-style: solid;
  outline-color: rgba(255, 0, 0, 0.5);
}

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Global background banner behind all content */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 40vh;
  background-image: url('/cards/banner.png');
  background-repeat: no-repeat;
  background-position: top center;
  background-size: cover;
  -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.1) 100%);
  mask-image: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.1) 100%);
  pointer-events: none;
  z-index: 0;
}

/* ===== Game UI (migrated from inline styles) ===== */
.hidden { display: none !important; }
.screen { width: 1000px; max-width: 100vw; height: 640px; max-height: 100vh; position: relative; padding: 24px; box-sizing: border-box; }
.panel { background: rgba(148, 140, 140, 0.55); border: 1px solid rgba(255,255,255,0.08); border-radius: 16px; padding: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.35); }
h1 { margin: 0 0 12px; font-size: 42px; }
h2 { margin: 0 0 16px; font-size: 28px; color: #000000; }
p { color: #d4d4d4; }
.btn { background: #22c55e; color: #000; border: none; border-radius: 10px; padding: 12px 18px; font-weight: 700; cursor: pointer; box-shadow: 0 8px 20px rgba(34,197,94,0.25); transition: all 0.3s ease; }
.btn:hover { transform: translateY(-2px); box-shadow: 0 12px 30px rgba(34,197,94,0.4); }
.btn:active { transform: translateY(0); }
.btn:disabled { background: #4b5563; color: #9ca3af; cursor: not-allowed; transform: none; box-shadow: none; }
.row { display: flex; gap: 12px; align-items: center; }
#select h2 { margin-bottom: 8px; }
#select .panel { display: flex; flex-direction: column; gap: 18px; max-width: 720px; margin: 0 auto; }
.select { background: #111827; color: #e5e7eb; border: 1px solid #374151; border-radius: 10px; padding: 12px 14px; min-width: 260px; }
.bar { display: flex; gap: 12px; flex-wrap: wrap; align-items: center; justify-content: center; }
.subtle { color: #a1a1aa; font-size: 13px; }
#landing { display: flex; align-items: center; justify-content: center; }
.hero { position: relative; width: 100%; height: 100%; }
.hero-panel { position: relative; width: 100%; height: 100%; border-radius: 28px; border: 1px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.40); -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px); overflow: hidden; z-index: 2; }
.dot-pattern { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: .30; pointer-events: none; }
.mouse-light { position: absolute; inset: 0; pointer-events: none; opacity: 0; transition: opacity .2s ease; background: radial-gradient(220px 220px at var(--mx, -9999px) var(--my, -9999px), rgba(255,255,255,0.10), rgba(255,255,255,0.04) 40%, transparent 60%); }
.mouse-light.show { opacity: 1; }
.rails { position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; }
.page-doodles { position: absolute; inset: 0; z-index: 1; pointer-events: none; }
.doodle { position: absolute; opacity: .9; filter: drop-shadow(0 0 24px rgba(255,255,255,0.18)); }
.doodle-a { left: -10px; bottom: 12px; width: 140px; transform: rotate(-8deg) }
.doodle-b { right: 8px; bottom: 24px; width: 160px; transform: rotate(10deg) }
.doodle-c { left: 50%; transform: translateX(-50%) rotate(0deg); bottom: -8px; width: 120px }
@keyframes float { 0% { transform: translateY(0) } 50% { transform: translateY(-10px) } 100% { transform: translateY(0) } }
.cube { position: absolute; filter: drop-shadow(0 0 36px rgba(255,255,255,0.35)); animation: float 4.5s ease-in-out infinite; opacity: .9; pointer-events: none }
.cube-1 { left: 40px; top: 100px; width: 64px }
.cube-2 { left: 80px; bottom: 120px; width: 56px; animation-delay: .25s }
.cube-3 { right: 64px; top: 112px; width: 64px; animation-delay: .4s }
.cube-4 { right: 96px; bottom: 120px; width: 80px; animation-delay: .7s }
.cube-5 { left: 50%; transform: translateX(-50%); bottom: 28px; width: 64px; animation-delay: .5s }
.mascot { position: absolute; right: 16px; bottom: 0; width: 300px; opacity: .95; pointer-events: none; user-select: none }
.hero-content { position: relative; z-index: 10; max-width: 820px; margin: 0 auto; text-align: center; padding: 64px 24px }
.hero-title { font-size: 56px; font-weight: 900; letter-spacing: -0.02em; margin: 0; background: linear-gradient(to bottom, #f8fafc, #ffffff 60%, #ffffff); -webkit-background-clip: text; background-clip: text; color: transparent; }
.hero-actions { display: flex; gap: 14px; align-items: center; justify-content: center; margin-top: 18px }
.hero-note { margin-top: 6px }
.scroll { margin-top: 22px; display: flex; align-items: center; gap: 8px; justify-content: center; opacity: .85 }
.dot { width: 8px; height: 8px; border-radius: 999px; background: rgba(255,255,255,.7); animation: dotPulse 1.6s infinite }
.dot:nth-child(2) { animation-delay: .5s }
@keyframes dotPulse { 0%, 100% { opacity: .5 } 50% { opacity: 1 } }
/* Game specifics */
#game .hud { position: absolute; top: 16px; left: 16px; display: flex; flex-direction: column; gap: 6px; z-index: 20 }
.tag { background: rgba(0,0,0,0.55); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; padding: 8px 12px; font-size: 14px; }
#game .controls { position: absolute; top: 16px; right: 16px; display: flex; gap: 10px; z-index: 20 }
#scene { position: absolute; top: 100px; left: 50%; transform: translateX(-50%); width: 800px; height: 450px; z-index: 5 }
.cat { position: absolute; top: -86px; left: 50%; transform: translateX(-35%); width: 100%; height: 100%; z-index: 10 }
.cat div { position: absolute; top: 0; width: 100%; height: 100%; background-repeat: no-repeat; background-size: contain; background-position: center }
#head { background-image: url('/bongo/assets/frames/frame_000.png'); z-index: 10 }
#mouth { background-image: url('/bongo/assets/frames/frame_000.png'); z-index: 20; opacity: 0 }
#paw-left { background-image: url('/bongo/assets/frames/hit_left.png'); z-index: 30; opacity: 0 }
#paw-right { background-image: url('/bongo/assets/frames/hit_right.png'); z-index: 30; opacity: 0 }
.instruments { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5 }
.instruments div { position: absolute; top: 0; width: 100%; height: 100%; background-repeat: no-repeat; background-size: contain; background-position: center }
#keyboard { background-image: url('/bongo/assets/frames/keyboard.png'); filter: brightness(.85) contrast(1.1); transition: all 0.2s ease; }
.keyboard-press { filter: brightness(1.2) contrast(1.2) !important; transform: scale(0.98); box-shadow: 0 0 20px rgba(0,255,136,0.5); }
#note-track { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); width: 600px; height: 120px; background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; overflow: hidden; z-index: 5; }
.note-lane { position: absolute; width: 60px; height: 100%; border-right: 1px dashed rgba(255,255,255,0.07); }
.note-lane:nth-child(1){left:0} .note-lane:nth-child(2){left:60px} .note-lane:nth-child(3){left:120px} .note-lane:nth-child(4){left:180px}
.note-lane:nth-child(5){left:240px} .note-lane:nth-child(6){left:300px} .note-lane:nth-child(7){left:360px} .note-lane:nth-child(8){left:420px}
.note-lane:nth-child(9){left:480px} .note-lane:nth-child(10){left:540px}
.hit-zone { position: absolute; bottom: 0; width: 100%; height: 20px; background: rgba(74,222,128,0.25); border-top: 2px solid #4ade80; animation: pulse 1s infinite; }
@keyframes pulse { 0%{ opacity:0.5 } 50%{ opacity:1 } 100%{ opacity:0.5 } }
.note { position: absolute; top: -20px; left: 5px; width: 50px; height: 20px; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; border-radius: 6px; border: 1px solid rgba(255,255,255,0.18); background: linear-gradient(45deg, #22c55e, #16a34a); z-index: 10; cursor: pointer; transition: all 0.2s ease; }
.note:hover { transform: scale(1.05); }
.note.perfect { background: linear-gradient(45deg, #f59e0b, #d97706); animation: perfectHit 0.5s ease; }
@keyframes perfectHit { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); }
}
.note.miss { background: linear-gradient(45deg, #ef4444, #b91c1c); animation: missShake 0.3s ease; }
@keyframes missShake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-3px); } 75% { transform: translateX(3px); } }
.score-popup { position: absolute; color: #22c55e; font-weight: 700; font-size: 20px; pointer-events: none; z-index: 100; animation: scoreFloat 1s ease-out forwards; }
@keyframes scoreFloat { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-40px) scale(1.2); opacity: 0; } }
.combo-display { position: absolute; bottom: 140px; left: 50%; transform: translateX(-50%); color: #8b5cf6; font-size: 32px; font-weight: 700; opacity: 0; transition: opacity 0.3s ease; z-index: 15; }
.combo-display.show { opacity: 1; animation: comboPulse 0.5s ease; }
@keyframes comboPulse { 0% { transform: translateX(-50%) scale(1); } 50% { transform: translateX(-50%) scale(1.1); } 100% { transform: translateX(-50%) scale(1); }
}

/* ===== Fixed top banner mask utility ===== */
.banner-mask {
  mask-image: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.1) 100%);
  -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.1) 100%);
  pointer-events: none;
}

.card { --radius: 4.55% / 3.5%; position: relative; z-index: calc(var(--s,1) * 100); transform: translate3d(0,0,0.1px); will-change: transform, visibility; transform-style: preserve-3d; }
.card.active { z-index: calc(var(--s,1) * 120); }
.card__translater, .card__rotator { display: grid; perspective: 600px; transform-origin: center; will-change: transform; }
.card__translater { width: auto; position: relative; transform: translate3d(var(--tx,0px), var(--ty,0px), 0) scale(var(--s,1)); }
.card__rotator { --glow: #6d69e96f; transform: rotateY(var(--ry,0deg)) rotateX(var(--rx,0deg)); transform-style: preserve-3d; box-shadow: 0 10px 20px -5px rgba(0,0,0,.6); border-radius: var(--radius); outline: none; transition: box-shadow .4s ease, outline .2s ease; }
.card.active .card__rotator, .card__rotator:focus { box-shadow: 0 0 10px 0 var(--glow), 0 0 10px 0 var(--glow), 0 0 30px 0 var(--glow); }
.card__rotator > * { width: 100%; display: grid; grid-area: 1/1; border-radius: var(--radius); image-rendering: optimizeQuality; transform-style: preserve-3d; }
.card__back { transform: rotateY(180deg); backface-visibility: visible; }
.card__front, .card__front * { backface-visibility: hidden; }
.card__front { opacity: 1; transition: opacity .2s ease-out; }
.card__shine, .card__glare { grid-area: 1/1; border-radius: var(--radius); pointer-events: none; }
.card__shine { background-image: radial-gradient(220px 180px at var(--mx,50%) var(--my,50%), rgba(255,255,255,.75) 0%, rgba(255,255,255,.28) 30%, rgba(255,255,255,0) 65%), linear-gradient(115deg, rgba(255,255,255,.18) 0%, rgba(255,255,255,0) 60%); background-blend-mode: screen, screen; background-size: auto, 220% 220%; background-position: center, calc(var(--posx,50%)) calc(var(--posy,50%)); filter: brightness(calc((var(--hyp,0) + .8))) contrast(1.8) saturate(1); opacity: calc(var(--o,0.8)); transition: opacity .12s ease; }
.card:hover .card__shine, .card.active .card__shine { opacity: 1; }
.card__glare { background-image: radial-gradient(120% 85% at var(--mx,50%) var(--my,50%), rgba(255,255,255,.25) 0%, rgba(255,255,255,.1) 35%, rgba(255,255,255,0) 70%); mix-blend-mode: screen; filter: blur(18px); opacity: calc(var(--o,0.6) * .9); }

/* Back card preview subtle shine */
.back-preview { position: absolute; inset: auto; border-radius: 12px; overflow: hidden; }
.back-preview img { display: block; width: 100%; height: auto; border-radius: 12px; }
.back-preview::after { content: ''; position: absolute; inset: 0; border-radius: 12px; pointer-events: none; background: radial-gradient(80% 60% at 70% 30%, rgba(255,255,255,.22), rgba(255,255,255,0) 60%); mix-blend-mode: screen; filter: blur(10px); opacity: .35; }

/* Card title font utility */
.card-title { font-family: "Times New Roman", Times, serif; font-style: italic; }
